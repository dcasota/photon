From cb60336a02de0d67e8925c4fb8650d8a09f335d5 Mon Sep 17 00:00:00 2001
From: Srish Srinivasan <ssrish@vmware.com>
Date: Sun, 3 Dec 2023 16:48:02 +0000
Subject: [PATCH] workaround for CVE-2023-46728

Refer: https://github.com/squid-cache/squid/security/advisories/GHSA-cg5h-v6vc-w33f
---
 src/cf.data.pre | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/cf.data.pre b/src/cf.data.pre
index 46b87c4..dc32c70 100644
--- a/src/cf.data.pre
+++ b/src/cf.data.pre
@@ -1853,6 +1853,11 @@ http_access deny !Safe_ports
 # Deny CONNECT to other than secure SSL ports
 http_access deny CONNECT !SSL_ports
 
+# Workaround for CVE-2023-46728
+# refer: https://github.com/squid-cache/squid/security/advisories/GHSA-cg5h-v6vc-w33f
+acl gopher proto gopher
+http_access deny gopher
+
 # Only allow cachemgr access from localhost
 http_access allow localhost manager
 http_access deny manager
-- 
2.35.6

