From 97e5c88f69611c4db275db954ec2655eaa6dcd49 Mon Sep 17 00:00:00 2001
From: Guruswamy Basavaiah <bguruswamy@vmware.com>
Date: Sat, 23 Sep 2023 13:41:32 +0530
Subject: [PATCH] PR25362, memory leak in nm

	PR 25362
	* nm.c (display_rel_file): Free dyn_syms.
---
 binutils/ChangeLog | 5 +++++
 binutils/nm.c      | 2 ++
 2 files changed, 7 insertions(+)

diff --git a/binutils/ChangeLog b/binutils/ChangeLog
index dffb66ba..a11e60ea 100644
--- a/binutils/ChangeLog
+++ b/binutils/ChangeLog
@@ -1,3 +1,8 @@
+2020-01-13  Alan Modra  <amodra@gmail.com>
+
+	PR 25362
+	* nm.c (display_rel_file): Free dyn_syms.
+
 2019-02-20  Alan Modra  <amodra@gmail.com>
 
 	PR 24233
diff --git a/binutils/nm.c b/binutils/nm.c
index 256f7e22..953607e6 100644
--- a/binutils/nm.c
+++ b/binutils/nm.c
@@ -1185,6 +1185,8 @@ display_rel_file (bfd *abfd, bfd *archive_bfd)
 	  *symp = 0;
 	  symcount += synth_count;
 	}
+      if (!dynamic && dyn_syms != NULL)
+	free (dyn_syms);
     }
 
   /* Discard the symbols we don't want to print.
-- 
2.25.1

